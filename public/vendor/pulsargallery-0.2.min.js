var PGObject_CloseButton=function(t){var n=document.createElement("div");$(n).hide(),n.appendChild(document.createTextNode("✖")),$(n).click(t);var s=!1;this.setPosition=function(t,e){$(n).css({position:"fixed","z-index":"35000",color:"#efefef","font-family":"Arial, Geneva, Helvetica, sans-serif","font-size":"18px","font-weight":"100",top:"20px",width:"100px","text-align":"right",display:"block"}),$(n).css("cursor","pointer"),$(n).attr("title","Закрыть");var i=t+e-110;$(n).css("left",i+"px"),$(n).show(),s||$("body").append(n),s=!0},this.hide=function(){$(n).hide()}},PGObject_Filmstrip=function(h){var d=this,p=110,u="pgimage0",f=document.createElement("div"),g=document.createElement("div"),m=document.createElement("div"),x=document.createElement("table"),v=document.createElement("tbody"),w=document.createElement("tr");f.appendChild(g),f.appendChild(m);var b=document.createElement("div"),_=document.createElement("span");f.appendChild(b),_.insertAdjacentHTML("beforeEnd",'<span style="font-size: 28px;">&laquo;</span>'),$(_).hover(function(){$(b).css("opacity","0.1"),$(this).css("opacity","0.8")},function(){$(b).css("opacity","0"),$(this).css("opacity","1")}),_.onmousedown=function(t){a++,o=!0,d.pg_playLeftDF()},_.onmouseup=function(t){a=0,o=!1},_.onmouseout=function(t){a=0,o=!1},f.appendChild(_);var y=document.createElement("div"),k=document.createElement("span");f.appendChild(y),k.insertAdjacentHTML("beforeEnd",'<span style="font-size: 28px;">&raquo;</span>'),$(k).hover(function(){$(y).css("opacity","0.1"),$(this).css("opacity","0.8")},function(){$(y).css("opacity","0"),$(this).css("opacity","1")}),k.onmousedown=function(t){s++,n=!0,d.pg_playRightDF()},k.onmouseup=function(t){s=0,n=!1},k.onmouseout=function(t){s=0,n=!1},f.appendChild(k);var P=!1,n=!1,s=0,o=!1,a=0;this.pres_arr=[],this.resize=function(){var t=$(window).width(),e=$(window).height(),i=Math.round(t/10);fsW=t-2*i,$(f).css({width:fsW+"px",left:i+"px",top:e-p+"px"});var n=Math.round(fsW/10),s=fsW-n,o=Math.round(n/2);$(g).css({width:s+"px","margin-left":o+"px"}),$(m).css({width:fsW+"px"}),$(b).css({width:o+"px",height:p+"px"}),$(_).css({width:o+"px",height:p+"px"}),$(_).css("cursor","pointer"),$(y).css({width:o+"px",height:p+"px","margin-left":o+s+"px"}),$(k).css({width:o+"px",height:p+"px","margin-left":o+s+"px"}),$(k).css("cursor","pointer")},this.pg_playRightDF=function(){var t=d.get_s();t<d.get_w()&&d.getStatusPlay("df_right","play")&&d.getStatusPlay("df_right","play_counter")<=2&&(t+=15,d.set_s(t),setTimeout(d.pg_playRightDF,30))},this.pg_playLeftDF=function(){var t=d.get_s();10<t&&d.getStatusPlay("df_left","play")&&d.getStatusPlay("df_left","play_counter")<=2&&(t-=15,d.set_s(t),setTimeout(d.pg_playLeftDF,30))},this.get_s=function(){return $(g).scrollLeft()},this.set_s=function(t){$(g).scrollLeft(t)},this.get_w=function(){return $(x).outerWidth()-$(g).outerWidth()},this.getStatusPlay=function(t,e){switch(t){case"df_right":switch(e){case"play":return n;case"play_counter":return s}break;case"df_left":switch(e){case"play":return o;case"play_counter":return a}}},this.setStatusPlay=function(t,e,i){switch(t){case"df_right":switch(e){case"play":n=i;break;case"play_counter":s=i}break;case"df_left":switch(e){case"play":o=i;break;case"play_counter":a=i}}},this.setPosition=function(t,e,i,n,s){var o=$(window).width(),a=$(window).height(),r=Math.round(o/10);fsW=o-2*r,$(f).css({position:"fixed",width:fsW+"px",height:p+"px","z-index":"50000",left:r+"px",top:a-p+"px"});var c=Math.round(fsW/10),l=fsW-c,h=Math.round(c/2);$(g).css({position:"absolute",width:l+"px",height:p+"px","z-index":"53000","margin-left":h+"px","text-align":"left",color:"#ffffff","font-family":"Arial, Geneva, Helvetica, sans-serif","font-weight":"100","border-left":"1px solid #757575","border-right":"1px solid #757575",overflow:"hidden"}),$(m).css({position:"absolute",width:fsW+"px",height:p+"px",background:"black",opacity:"0.2","border-radius":"10px 10px 0 0","z-index":"51000"}),$(b).css({position:"absolute",width:h+"px",height:p+"px",background:"black",opacity:"0","z-index":"60000","margin-left":"0px"}),$(_).css({position:"absolute",width:h+"px",height:p+"px","z-index":"61000","text-align":"center",color:"#aaaaaa","font-family":"Arial, Geneva, Helvetica, sans-serif","font-size":"38px","font-weight":"100","margin-left":"0px","padding-top":"30px"}),$(_).css("cursor","pointer"),$(y).css({position:"absolute",width:h+"px",height:p+"px",background:"black",opacity:"0","z-index":"60000","margin-left":h+l+"px"}),$(k).css({position:"absolute",width:h+"px",height:p+"px","z-index":"61000","text-align":"center",color:"#aaaaaa","font-family":"Arial, Geneva, Helvetica, sans-serif","font-size":"38px","font-weight":"100","margin-left":h+l+"px","padding-top":"30px"}),$(k).css("cursor","pointer"),this.setList(t,e,i,n,s),P||$("body").append(f),P=!0,$(f).show()},this.hide=function(){$(f).hide()},this.getInfo=function(n,t,e,i){var s=[],o=0,a=0;return console.log("a[rel='"+t+"["+e+"]']"),$("a[rel='"+t+"["+e+"]']").each(function(t,e){var i;e.href==n&&(a=o),$(this).find("img").each(function(t,e){i=e.src}),s.push({image:e.href,thumb:i,title:this.title}),o++}),{arr:s,count:a,allcount:o,object:d,infoType:i}},this.setList=function(s,o,a,r,c){console.log(s);var t=0,e=s.arr;for(var i in e){var n={image:null,container:null};n.image=new Image,n.image.src=e[i].thumb,n.image.setAttribute("maximage",e[i].image),n.image.setAttribute("title",e[i].title),n.image.setAttribute("id","pgimage"+i),n.image.setAttribute("name","pgimage"+i),n.image.setAttribute("key",i),t+=5,n.image.setAttribute("thwh",t);var l=n.image.width/n.image.height;t+=Math.round(100*l),$(n.image).css({height:"100px",margin:"0px 5px 0px 0px",cursor:"pointer"}),n.image.onclick=function(){var t=this.getAttribute("maximage"),e=this.getAttribute("title"),i=this.getAttribute("id"),n=(this.getAttribute("thwh"),this.getAttribute("key"));$("#"+u).css("border","0px solid black"),$(this).css("border","1px solid #eeeeee"),u=i,o.setPosition(t,s.count,s.allcount,a,r,c,e,!0),h.setCounter(n)},n.container=document.createElement("td"),n.container.appendChild(n.image),w.appendChild(n.container),d.pres_arr.push(n)}v.appendChild(w),x.appendChild(v),$(g).append(x),void 0!==d.pres_arr[s.count]&&(element=$(d.pres_arr[s.count].image),element.stop(!1,!1),$(g).animate({scrollLeft:element.attr("thwh")},"slow"),$("#"+u).css("border","0px solid black"),element.css("border","1px solid #eeeeee"),u="pgimage"+s.count)},this.getCurrentIm=function(){return u},this.setCurrentIm=function(t){u=t},this.clean=function(){for(var t in d.pres_arr)$(d.pres_arr[t].image).remove(),$(d.pres_arr[t].container).remove();d.pres_arr.length=0}},PGObject_Image=function(t){var e=document.createElement("div");$(e).click(t);var v,w,b,_,y,k,P=document.createElement("div"),z=new Image,i=!1;this.resize=function(t,e,i,n,s){var o,a,r=$(window).width(),c=$(window).height(),l=Math.round(r/18);if(r<c&&(k=!1),0==b&&0==_||k)if(0!=b||0!=_||k){var h=Math.round(l/4)+30;$(z).attr("title","Запуск слайд-шоу"),$(z).css("cursor","pointer"),canvas_w=r-2*l-2*h,canvas_h=c-110-50-h}else canvas_w=r-Math.round(l/4),canvas_h=c-50-30,$(z).attr("title",y),$(z).css("cursor","default");else canvas_w=r-2*l,canvas_h=c-50-30,$(z).attr("title","Запуск слайд-шоу"),$(z).css("cursor","pointer");if(ratio_convas=canvas_w/canvas_h,v<canvas_w&&w<canvas_h)o=v,a=w;else{var d=v/w;a=d<=ratio_convas?(o=canvas_h*d,canvas_h):(o=canvas_w,canvas_w/d)}var p=r/2-o/2,u=Math.round(o),f=Math.round(a);$(z).width(u),$(z).height(f),$(P).width(u),$(P).height(f),$(P).css("left",p),s&&(t.setPosition(p,u),e.setPosition(p,u,n,v,w,b,_),i.setPosition(p,f,y))},this.setPosition=function(d,p,u,f,g,m,x,t){b=p,_=u,y=x,k=t,$(e).css({position:"fixed",top:"0px",left:"0px",margin:"0px",padding:"0px",width:"100%",height:"100%",background:"black",opacity:"0.5","z-index":"10000"}),$(e).show(),$(P).css({position:"fixed",left:"0px",top:"50px",margom:"0px",padding:"0px","text-align":"center","z-index":"11000",color:"white"}),$(P).show(),$(z).hide(),z.src=d,$(z).on("load",function(){$(this).removeAttr("width").removeAttr("height").css({width:"",height:""}),v=$(this).width(),w=$(this).height();var t=$(window).width(),e=$(window).height();t<e&&(k=!1);var i,n,s=Math.round(t/18),o="Следующие изображение";if(console.log("infoTypeThis: "+k),0==b&&0==_||k)if(0!=b||0!=_||k){var a=Math.round(s/4)+30;$(z).attr("title",o),$(z).css("cursor","pointer"),canvas_w=t-2*s-2*a,canvas_h=e-110-50-a}else canvas_w=t-Math.round(s/4),canvas_h=e-50-30,$(z).attr("title",x),$(z).css("cursor","default");else canvas_w=t-2*s,canvas_h=e-50-30,$(z).attr("title",o),$(z).css("cursor","pointer");if(ratio_convas=canvas_w/canvas_h,v<canvas_w&&w<canvas_h)i=v,n=w;else{var r=v/w;n=r<=ratio_convas?(i=canvas_h*r,canvas_h):(i=canvas_w,canvas_w/r)}var c=t/2-i/2,l=Math.round(i),h=Math.round(n);$(this).width(l),$(this).height(h),$(P).width(l),$(P).height(h),$(P).css("left",c),$(this).show(),f.setPosition(c,l),g.setPosition(c,l,d,v,w,p,u),m.setPosition(c,h,x)}),i||($(P).html(z),$("body").append(e),$("body").append(P)),i=!0},this.hide=function(){$(e).hide(),$(P).hide()},this.getImageLink=function(){return z},this.setOpacityBG=function(t){$(e).css("opacity",t)}},PGObject_InformText=function(){var d=document.createElement("div");$(d).hide(),d.appendChild(document.createTextNode("загрузка...")),d.title="подсчёт изображений загруженных на страницу";var t="&#x25BA;",p=document.createElement("span");$(p).css({border:"1px solid silver",padding:"2px 5px","margin-left":"20px"});var e=document.createElement("span");$(e).css({color:"#dddddd",cursor:"pointer"}),$(e).attr("title","Запуск слайд-шоу"),$(e).html(t),p.appendChild(e);var u=!1;this.setStartIcon=function(){$(e).attr("title","Запуск слайд-шоу"),$(e).html(t)},this.setStopIcon=function(){$(e).attr("title","Остановить слайд-шоу"),$(e).html("&#8709;")},this.getLinkStartButton=function(){return e},this.setPosition=function(t,e,i,n,s,o,a){var r=$(window).width();$(d).css({position:"fixed","z-index":"30000",color:"#dddddd","font-family":"Arial, Geneva, Helvetica, sans-serif","font-size":"14px","font-weight":"100",left:r/2-50+"px",top:"26px",width:"500px","text-align":"left",display:"block"});var c='<a href="'+i+'" target="_blank" style="color:#dddddd;" title="Откроется в новом окне">полный размер</a>',l=t+10;$(d).css("left",l+"px"),e<480&&360<e?$(d).css("font-size","11px"):e<=360&&330<e?$(d).css("font-size","10px"):e<=330&&$(d).css("font-size","9px");var h="изображение "+(o+1)+" из "+a+" &nbsp;—&nbsp; "+n+"&times;"+s;0==o&&0==a?(h=n+"&times;"+s,$(d).html(h+" "+c+" ")):($(d).html(h+" "+c+" "),$(d).append(p)),$(d).show(),u||$("body").append(d),u=!0},this.hide=function(){$(d).hide()},this.setInform=function(t){$(d).html(t)}},PGObject_TitleText=function(){var o=document.createElement("div");$(o).hide();var a=!1;this.setPosition=function(t,e,i){$(o).css({position:"fixed","z-index":"30000",color:"#dddddd","font-family":"Arial, Geneva, Helvetica, sans-serif","font-size":"16px","font-weight":"100",width:"400px","text-align":"left"});var n=e+60,s=t+10;$(o).css("left",s+"px"),$(o).css("top",n+"px"),$(o).html(i),$(o).show(),a||$("body").append(o),a=!0},this.hide=function(){$(o).hide()}},PGObject_Vectors=function(){var r,c=this,l={fsInfo:null,closeButton:null,informText:null,titleText:null,image:null,status:!1},h=!1,d=!0,t="25px solid #454545",e="25px solid #555555",o=document.createElement("div"),a=document.createElement("div"),p=document.createElement("div"),i=document.createElement("div");$(p).css("position","relative"),$(p).css("width","50px"),$(p).css("opacity","0.6"),$(i).css("position","relative"),$(i).css("border","25px solid transparent"),$(i).css("border-right",t),$(p).hover(function(){$(i).css("border-right",e)},function(){$(i).css("border-right",t)}),o.appendChild(a),p.appendChild(i),o.appendChild(p);var u=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div"),n=document.createElement("div");$(g).css("position","relative"),$(g).css("width","50px"),$(g).css("opacity","0.6"),$(n).css("position","absolute"),$(n).css("border","25px solid transparent"),$(n).css("border-left",t),$(g).hover(function(){$(n).css("border-left",e)},function(){$(n).css("border-left",t)}),u.appendChild(f),g.appendChild(n),u.appendChild(g);var m=function(t,e,i,n,s){var o=t.count,a=t.object,r=(a.get_s(),a.getCurrentIm());if(0==t.count?o=t.allcount-1:o--,t.count=o,s.setPosition(t.arr[o].image,o,t.allcount,e,i,n,t.arr[o].title,t.infoType),l={fsInfo:t,closeButton:e,informText:i,titleText:n,image:s,status:!0},t.infoType){var c=a.pres_arr[o].image;$("#"+r).css("border","0px solid black"),$(c).css("border","1px solid #eeeeee"),a.setCurrentIm("pgimage"+o),a.set_s(parseInt($(c).attr("thwh")))}},x=function(t,e,i,n,s){var o=t.count,a=t.object,r=(a.get_s(),a.getCurrentIm());if(t.count==t.allcount-1?o=0:o++,t.count=o,s.setPosition(t.arr[o].image,o,t.allcount,e,i,n,t.arr[o].title,t.infoType),l={fsInfo:t,closeButton:e,informText:i,titleText:n,image:s,status:!0},t.infoType){var c=a.pres_arr[o].image;$("#"+r).css("border","0px solid black"),$(c).css("border","1px solid #eeeeee"),a.setCurrentIm("pgimage"+o),a.set_s(parseInt($(c).attr("thwh")))}};$(document).keypress(function(t){39!=t.keyCode&&13!=t.keyCode||!l.status?37==t.keyCode&&l.status&&m(l.fsInfo,l.closeButton,l.informText,l.titleText,l.image):x(l.fsInfo,l.closeButton,l.informText,l.titleText,l.image)});var v=!1;this.interval=5,this.setClickImage=function(t){d=t},this.resize=function(){var t=$(window).width(),e=$(window).height(),i=Math.round(t/18),n=e/2-50,s=t-i;$(o).css({width:i+"px"}),$(p).css({"padding-top":n+"px"}),$(u).css({left:s+"px",width:i+"px"}),$(g).css({"padding-top":n+"px"})},this.setObject=function(t,e,i,n,s,o){l={fsInfo:t,closeButton:e,informText:i,titleText:n,image:s,status:o}},this.setStatus=function(t,e,i,n,s,o){l.status=o},this.setCounter=function(t){l.fsInfo.count=t},this.setPosition=function(){var t=$(window).width(),e=$(window).height(),i=Math.round(t/18),n=e/2-50,s=t-i;$(o).css({position:"fixed",top:"0px",left:"0px",margin:"0px",padding:"0px",width:i+"px",height:"100%",display:"block","z-index":"10000"}),$(a).css({position:"absolute",width:"100%",height:"100%",background:"black",opacity:"0","z-index":"20000"}),$(p).css({position:"absolute",width:"100%",height:"100%","z-index":"30000","text-align":"right",color:"#aaaaaa","font-family":"Arial, Geneva, Helvetica, sans-serif","font-size":"38px","font-weight":"100","padding-top":n+"px"}),$(p).css("cursor","pointer"),$(u).css({position:"fixed",top:"0px",left:s+"px",margin:"0px",padding:"0px",width:i+"px",height:"100%",display:"block","z-index":"10000"}),$(f).css({position:"absolute",width:"100%",height:"100%",background:"black",opacity:"0","z-index":"20000"}),$(g).css({position:"absolute",width:"100%",height:"100%","z-index":"30000","text-align":"center",color:"#aaaaaa","font-family":"Arial, Geneva, Helvetica, sans-serif","font-size":"38px","font-weight":"100","padding-top":n+"px"}),$(g).css("cursor","pointer"),v||($("body").append(o),$("body").append(u)),v=!0},this.left=function(e,i,n,s,o){var a=this;p.onclick=function(t){a.stopSlideShow(),m(e,i,n,s,o)}},this.stopSlideShow=function(){clearInterval(r),h=!1},this.right=function(e,i,n,s,o){var a=this;g.onclick=function(t){a.stopSlideShow(),x(e,i,n,s,o)},o.getImageLink().onclick=function(t){a.stopSlideShow(),d&&x(e,i,n,s,o)},n.getLinkStartButton().onclick=function(t){h?(n.setStartIcon(),a.stopSlideShow(),o.setOpacityBG("0.5")):(n.setInform("слайд-шоу запущено..."),n.setStopIcon(),o.setOpacityBG("0.8"),r=setInterval(function(){x(e,i,n,s,o),o.setOpacityBG("0.8")},1e3*c.interval),h=!0)}},this.hide=function(){$(o).hide(),$(u).hide(),clearInterval(r),h=!1}},PulsarGallery=function(){var o=this,r=!1;this.close=function(){r=!1,c.hide(),l.hide(),h.hide(),d.hide(),p.hide(),u.hide(),p.setStatus(!1)};var c=new PGObject_CloseButton(this.close),l=new PGObject_InformText,h=new PGObject_TitleText,d=new PGObject_Image(this.close),p=new PGObject_Vectors,u=new PGObject_Filmstrip(p);this.alias="pulsargallery",this.aliaslite="pulsarlite",this.name="list1",this.action=!0,this.interval=5,this.resize=function(){this.action&&(p.resize(),d.resize(c,l,h,this.href,r),u.resize())},this.actionGal=function(t,e,i,n,s){r=!0;var o=$(window).width(),a=$(window).height();p.setClickImage(!0),s&&u.clean(),d.setPosition(e,i.count,i.allcount,c,l,h,t,n),a<=o&&(p.setPosition(),s&&u.setPosition(i,d,c,l,h)),p.setObject(i,c,l,h,d,n),p.left(i,c,l,h,d),p.right(i,c,l,h,d)},this.init=function(){var n=this;if(this.action){p.interval=this.interval;var t,e,i=new RegExp("^"+this.alias+"\\[([a-zA-Z0-9]+)\\]|"+this.name+"$"),s=new RegExp("^"+this.aliaslite+"\\[([a-zA-Z0-9]+)\\]|"+this.name+"$");$("a").each(function(){this.rel&&(t=this.rel.match(i))?($(this).attr("data-group",t[1]),this.onclick=function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0;var e=$(this).attr("data-group"),i=u.getInfo(this.href,n.alias,e,!0);return console.log(i),o.actionGal(this.title,this.href,i,!0,!0),!1}):this.rel&&(e=this.rel.match(s))&&($(this).attr("data-group",e[1]),this.onclick=function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0;var e=$(this).attr("data-group"),i=u.getInfo(this.href,n.alias,e,!1);return o.actionGal(this.title,this.href,i,!1,!1),!1})}),$("a[rel='"+this.alias+"']").on("click",function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0;var e=this.title,i=this.href;return p.setClickImage(!1),d.setPosition(i,0,0,c,l,h,e),!1}),$(window).resize(function(){o.resize()})}},this.toFormatFilmStrip=function(t,e,i){return{arr:e,count:t,allcount:e.length,infoType:i,object:u}},this.open=function(t,e,i,n){if(this.action){var s=this.toFormatFilmStrip(t,n,e);o.actionGal(n[t].title,n[t].image,s,e,i),$(window).resize(function(){o.resize()})}}},pulsargallery=new PulsarGallery;